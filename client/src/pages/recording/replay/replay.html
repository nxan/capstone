<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>RR Web recording...</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/rrweb@latest/dist/rrweb.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/rrweb-player@latest/dist/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/rrweb@latest/dist/rrweb.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/rrweb-player@latest/dist/index.js"></script>
</head>

<body>
    <script>
        let fileName = 'events';

        fetch('http://localhost:8888/read', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ fileName: fileName })
        }).then((data) => data.json()).then((data) => {
            return replayFormatSetter(data);
        }).then((playerData) => {
            replay(playerData);
        }).catch(error => console.log(error));

        function replayFormatSetter(argument) {
            let playerString = [];
            argument.forEach((entry) => {
                playerString = playerString.concat(entry);
            });
            return playerString;
        }


        function replay(events) {
            new rrwebPlayer({
                target: document.body,
                data: { events }
            })
            replayer.play()
        }

    </script>
</body>